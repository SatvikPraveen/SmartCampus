# File location: src/main/resources/config/database.properties
# Database Configuration for SmartCampus System

# ==================== PRIMARY DATABASE CONFIGURATION ====================
# PostgreSQL Configuration (Primary)
db.primary.driver=org.postgresql.Driver
db.primary.url=jdbc:postgresql://localhost:5432/smartcampus_primary
db.primary.username=campus_admin
db.primary.password=S3cur3P@ssw0rd!
db.primary.catalog=smartcampus
db.primary.schema=public

# Connection Pool Configuration (HikariCP)
db.primary.hikari.pool-name=SmartCampusPrimaryPool
db.primary.hikari.maximum-pool-size=25
db.primary.hikari.minimum-idle=5
db.primary.hikari.idle-timeout=300000
db.primary.hikari.max-lifetime=1800000
db.primary.hikari.connection-timeout=30000
db.primary.hikari.validation-timeout=5000
db.primary.hikari.leak-detection-threshold=60000
db.primary.hikari.auto-commit=true

# Connection Properties
db.primary.connection.charset=UTF-8
db.primary.connection.timezone=UTC
db.primary.connection.ssl=false
db.primary.connection.ssl-mode=disable

# ==================== READ REPLICA DATABASE CONFIGURATION ====================
# Read Replica for Query Optimization
db.replica.enabled=true
db.replica.driver=org.postgresql.Driver
db.replica.url=jdbc:postgresql://replica.localhost:5432/smartcampus_replica
db.replica.username=campus_reader
db.replica.password=R3ad3rP@ssw0rd!
db.replica.read-only=true

# Replica Pool Configuration
db.replica.hikari.pool-name=SmartCampusReplicaPool
db.replica.hikari.maximum-pool-size=15
db.replica.hikari.minimum-idle=3
db.replica.hikari.idle-timeout=300000
db.replica.hikari.connection-timeout=30000

# ==================== H2 DATABASE (TESTING) ====================
# In-Memory Database for Testing
db.test.driver=org.h2.Driver
db.test.url=jdbc:h2:mem:smartcampus_test;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
db.test.username=sa
db.test.password=
db.test.schema=PUBLIC
db.test.mode=PostgreSQL

# H2 Console (Development Only)
db.test.h2.console.enabled=true
db.test.h2.console.path=/h2-console

# ==================== DATABASE DIALECT CONFIGURATION ====================
# Hibernate Dialect
db.hibernate.dialect=org.hibernate.dialect.PostgreSQL10Dialect
db.hibernate.dialect.test=org.hibernate.dialect.H2Dialect

# JPA Configuration
db.jpa.show-sql=false
db.jpa.format-sql=true
db.jpa.generate-ddl=false
db.jpa.hibernate.ddl-auto=validate

# ==================== MIGRATION CONFIGURATION ====================
# Flyway Migration Settings
db.migration.enabled=true
db.migration.locations=classpath:sql/migrations
db.migration.baseline-on-migrate=false
db.migration.validate-on-migrate=true
db.migration.clean-disabled=true
db.migration.table=schema_version

# Migration Placeholders
db.migration.placeholders.defaultSchema=public
db.migration.placeholders.defaultTablespace=pg_default

# ==================== TRANSACTION CONFIGURATION ====================
# Transaction Management
db.transaction.timeout=30
db.transaction.isolation=READ_COMMITTED
db.transaction.default-rollback=true

# Batch Processing
db.batch.size=50
db.batch.versioned-data=false
db.batch.order-inserts=true
db.batch.order-updates=true

# ==================== QUERY CONFIGURATION ====================
# Query Optimization
db.query.timeout=30000
db.query.fetch-size=100
db.query.max-results=1000
db.query.cache.enabled=true
db.query.cache.size=100

# Second Level Cache
db.cache.use_second_level_cache=true
db.cache.use_query_cache=true
db.cache.provider=org.hibernate.cache.jcache.JCacheRegionFactory
db.cache.region.factory_class=org.hibernate.cache.jcache.JCacheRegionFactory

# ==================== LOGGING CONFIGURATION ====================
# Database Logging
db.logging.level=WARN
db.logging.show-sql=false
db.logging.format-sql=false
db.logging.use-sql-comments=true
db.logging.log-slow-queries=true
db.logging.slow-query-threshold=2000

# Connection Logging
db.logging.connection.enabled=false
db.logging.connection.level=DEBUG

# ==================== PERFORMANCE MONITORING ====================
# Database Metrics
db.metrics.enabled=true
db.metrics.jmx.enabled=true
db.metrics.statistics.enabled=true
db.metrics.connection-pool.enabled=true

# Performance Statistics
db.statistics.enabled=true
db.statistics.log-summary=true
db.statistics.log-queries=false

# ==================== SECURITY CONFIGURATION ====================
# Database Security
db.security.encrypt-connection=false
db.security.trust-server-certificate=false
db.security.user-ssl=false

# Connection Validation
db.validation.enabled=true
db.validation.query=SELECT 1
db.validation.on-borrow=true
db.validation.on-return=false
db.validation.while-idle=true
db.validation.interval=30000

# ==================== BACKUP CONFIGURATION ====================
# Database Backup Settings
db.backup.enabled=true
db.backup.schedule=0 2 * * *
db.backup.directory=/var/backups/smartcampus/
db.backup.retention.days=30
db.backup.compression=true
db.backup.format=custom

# Backup Commands
db.backup.command=pg_dump
db.backup.restore.command=pg_restore
db.backup.options=--verbose --clean --no-acl --no-owner

# ==================== DEVELOPMENT SETTINGS ====================
# Development Database Settings
db.dev.auto-create=false
db.dev.drop-first=false
db.dev.show-sql=true
db.dev.format-sql=true
db.dev.generate-statistics=true

# Test Data Loading
db.dev.load-test-data=true
db.dev.test-data.location=classpath:sql/test-data.sql

# ==================== ENVIRONMENT SPECIFIC OVERRIDES ====================
# Production Environment
db.prod.url=jdbc:postgresql://prod-db-cluster.internal:5432/smartcampus
db.prod.username=${DB_USERNAME}
db.prod.password=${DB_PASSWORD}
db.prod.hikari.maximum-pool-size=50
db.prod.ssl=true
db.prod.ssl-mode=require

# Staging Environment
db.staging.url=jdbc:postgresql://staging-db.internal:5432/smartcampus_staging
db.staging.username=${DB_STAGING_USERNAME}
db.staging.password=${DB_STAGING_PASSWORD}
db.staging.hikari.maximum-pool-size=20

# Development Environment
db.dev.url=jdbc:postgresql://localhost:5432/smartcampus_dev
db.dev.username=dev_user
db.dev.password=dev_password
db.dev.hikari.maximum-pool-size=10
db.dev.show-sql=true

# ==================== CONNECTION HEALTH CHECKS ====================
# Health Check Configuration
db.health.enabled=true
db.health.query=SELECT 1
db.health.timeout=5000
db.health.interval=30000

# Circuit Breaker
db.circuit-breaker.enabled=true
db.circuit-breaker.failure-threshold=5
db.circuit-breaker.recovery-timeout=30000
db.circuit-breaker.success-threshold=3

# ==================== AUDIT CONFIGURATION ====================
# Database Audit Settings
db.audit.enabled=true
db.audit.table-suffix=_audit
db.audit.timestamp-column=audit_timestamp
db.audit.user-column=audit_user
db.audit.action-column=audit_action

# ==================== PARTITIONING CONFIGURATION ====================
# Table Partitioning (for large datasets)
db.partitioning.enabled=false
db.partitioning.strategy=RANGE
db.partitioning.column=created_date
db.partitioning.interval=MONTHLY

# Large Table Settings
db.large-tables.grades.partition=true
db.large-tables.enrollments.partition=true
db.large-tables.audit-logs.partition=true

# ==================== CUSTOM CONNECTION PROPERTIES ====================
# PostgreSQL Specific Properties
db.postgresql.application-name=SmartCampus
db.postgresql.prepare-threshold=5
db.postgresql.default-row-fetch-size=0
db.postgresql.log-unclosed-connections=true
db.postgresql.assume-min-server-version=10

# Connection URL Parameters
db.url.params.tcpKeepAlive=true
db.url.params.socketTimeout=0
db.url.params.loginTimeout=10
db.url.params.connectTimeout=10